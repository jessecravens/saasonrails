%p
  User: #{@user.full_name}
%p
  Email: #{@user.email if @user.email}

- if @user.avatar.present?
  .thumbnail.span2
    = image_tag @user.avatar.url
- else
  %p 
    No avatar

= render 'avatar_form', profile: @user.profile

%h3 Authentications:
.row
  .thumbnail.span1= image_tag 'facebook.png'
  .span10
    - if @user.authentications.facebook.present?
      - authentication = @user.authentications.facebook.first
      %p UID: #{authentication.uid}
      %p Access Token: #{authentication.access_token}
      = link_to 'Remove', authentication_path(authentication), method: :delete
    - else
      = link_to 'Add Facebook', user_omniauth_authorize_path(:facebook)
%br
.row
  .thumbnail.span1= image_tag 'google.png'
  .span10
    - if @user.authentications.google.present?
      - authentication = @user.authentications.google.first
      %p UID: #{authentication.uid}
      = link_to 'Remove', authentication_path(authentication), method: :delete
    - else
      = link_to 'Add Google', user_omniauth_authorize_path(:google)

%br

- if @user.has_role?(:owner)
  %h3 Current Subscription:
  = link_to 'Change Plan', edit_subscription_path(@user.subscription)
  %dl
    %dt Plan
    %dd= @user.subscription.plan.name

    %dt Amount
    %dd= number_to_currency @user.subscription.plan.amount

    %dt Started At
    %dd= Time.at(@user.subscription.started_at).to_time.to_s(:long)

  %h3 Previous Subscription(s):
  - if @user.subscriptions.not_active.present?
    - @user.subscriptions.not_active.desc(:ended_at).each do |subscription|
      %dl
        %dt Plan
        %dd= subscription.plan.name

        %dt Amount
        %dd= number_to_currency subscription.plan.amount

        %dt Started At
        %dd= Time.at(subscription.started_at).to_time.to_s(:long)

        %dt Ended At
        %dd= Time.at(subscription.ended_at).to_time.to_s(:long)
